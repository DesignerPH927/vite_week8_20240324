import{S as p}from"./sweetalert2.all--wY0wpLr.js";import{_ as k,m as C,r as m,o as b,c as f,d as l,a as e,F as g,g as T,w as L,b as _,t as u,e as h,n as d}from"./index-IH5Zc-RJ.js";import{T as M}from"./ToastMessage-e6ahaWgt.js";import{u as S}from"./statusStore-34fkjK9S.js";var U={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"getmarried",BASE_URL:"/vite_week8_20240324/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:v,VITE_PATH:V}=U,P={data(){return{form:{user:{email:"",name:"",tel:"",address:"",paid:""},message:""},isLoading:!1,remoteCarts:[]}},components:{ToastMessages:M},methods:{...C(S,["pushMessage"]),backPage(){this.$router.go(-1)},getCarts(){this.isLoading=!0,this.$http(`${v}/api/${V}/cart`).then(r=>{this.isLoading=!1,this.remoteCarts=r.data.data}).catch(r=>{this.isLoading=!1,this.pushMessage({style:"danger",title:"錯誤訊息",content:r.response.data.message})})},onSubmit(){const r=this.form;this.$http.post(`${v}/api/${V}/order`,{data:r}).then(s=>{p.fire({icon:"success",title:"已建立訂單囉"}).then(()=>{this.$refs.form.resetForm(),this.$router.push(`/carts/isPaid/${s.data.orderId}`)})}).catch(()=>{p.fire({icon:"warning",title:"購物車沒品項唷",showConfirmButton:!0})})},isPhone(r){return/^(09)[0-9]{8}$/.test(r)?!0:"電話號碼需 09 開頭唷"},resetData(){this.$refs.form.resetForm()}},mounted(){this.getCarts()}},D={class:"row g-lg-5 g-3 justify-content-center"},E={class:"col-lg-6"},q={class:"card me-auto border border-lilac",style:{background:"#ffeeff"}},A={class:"card-body"},B={class:"table-responsive"},F={class:"table align-middle text-nowrap"},N=e("thead",null,[e("tr",{class:"text-center"},[e("th",null,"縮圖"),e("th",null,"商品"),e("th",null,"數量"),e("th",null,"單價")])],-1),R={style:{width:"200px"}},j=["src"],H={class:"d-flex justify-content-between align-items-center"},I=e("i",{class:"bi bi-arrow-left"},null,-1),O={class:"text-end fw-bold fs-4 mb-0"},z=e("i",{class:"bi bi-currency-dollar"},null,-1),G={class:"col-lg-6"},J={class:"card ms-auto border border-lilac",style:{background:"#ffeeff"}},K={class:"card-body px-lg-5 p-4"},Q=e("h3",{class:"fw-bold text-center"}," 請填寫表單 ",-1),W={class:"row"},X={class:"col-lg-6"},Y={class:"mb-3"},Z=e("label",{for:"mail",class:"form-label fw-bold"}," 信箱 ",-1),$={class:"col-lg-6"},ee={class:"mb-3"},se=e("label",{for:"name",class:"form-label fw-bold"}," 姓名 ",-1),te={class:"col-lg-6"},oe={class:"mb-3"},le=e("label",{for:"tel",class:"form-label fw-bold"}," 電話 ",-1),ae={class:"col-lg-6"},re={class:"mb-3"},ne=e("label",{for:"address",class:"form-label fw-bold"}," 地址 ",-1),ie=e("option",{value:"",selected:"",disabled:""}," 請選擇地區 ",-1),de=e("option",{value:"台北市"},"台北市",-1),ce=e("option",{value:"新北市"},"新北市",-1),me=e("option",{value:"桃園市"},"桃園市",-1),ue=e("option",{value:"新竹市"},"新竹市",-1),_e=e("option",{value:"台中市"},"台中市",-1),be={class:"col-lg-6"},fe={class:"mb-3"},he=e("label",{for:"address",class:"form-label fw-bold"}," 付款方式 ",-1),pe=e("option",{value:"",selected:"",disabled:""}," 請選擇付款方式 ",-1),ge=e("option",{value:"台北市"},"信用卡",-1),ve=e("option",{value:"新北市"},"貨到付款",-1),Ve=e("option",{value:"桃園市"},"ATM 轉帳",-1),we={class:"mb-3"},ye=e("label",{for:"message",class:"form-label fw-bold"}," 留言 ",-1),xe={class:"d-flex justify-content-end align-items-center"},ke=e("button",{class:"btn btn-lilac",type:"submit"},[_(" 確認結帳 "),e("i",{class:"bi bi-arrow-right"})],-1);function Ce(r,s,Te,Le,t,n){const w=m("VLoading"),y=m("ToastMessages"),i=m("VField"),c=m("error-message"),x=m("VForm");return b(),f(g,null,[l(w,{active:t.isLoading},null,8,["active"]),l(y),e("div",D,[e("div",E,[e("div",q,[e("div",A,[e("div",B,[e("table",F,[N,e("tbody",null,[(b(!0),f(g,null,T(t.remoteCarts.carts,o=>(b(),f("tr",{key:o.id,class:"text-center"},[e("td",R,[e("div",null,[e("img",{src:o.product.imageUrl,class:"img-thumbnail"},null,8,j)])]),e("th",null,u(o.product.category),1),e("td",null,u(o.qty),1),e("td",null,"$"+u(o.total),1)]))),128))])]),e("div",H,[e("button",{class:"btn btn-lilac",type:"button",onClick:s[0]||(s[0]=L((...o)=>n.backPage&&n.backPage(...o),["prevent"]))},[I,_(" 回上一步 ")]),e("p",O,[_(" 總價 "),z,_(" "+u(t.remoteCarts.total),1)])])])])])]),e("div",G,[e("div",J,[e("div",K,[Q,l(x,{action:"#",onSubmit:n.onSubmit,ref:"form"},{default:h(({errors:o})=>[e("div",W,[e("div",X,[e("div",Y,[Z,l(i,{id:"mail",type:"mail",name:"信箱",class:d(["form-control bg-transparent border border-lilac",{"is-invalid":o.信箱}]),placeholder:"請輸入信箱",rules:"email|required",modelValue:t.form.user.email,"onUpdate:modelValue":s[1]||(s[1]=a=>t.form.user.email=a)},null,8,["modelValue","class"]),l(c,{name:"信箱",class:"invalid-feedback"})])]),e("div",$,[e("div",ee,[se,l(i,{id:"name",type:"text",name:"姓名",class:d(["form-control bg-transparent border border-lilac",{"is-invalid":o.姓名}]),rules:"required",modelValue:t.form.user.name,"onUpdate:modelValue":s[2]||(s[2]=a=>t.form.user.name=a),placeholder:"請輸入姓名"},null,8,["modelValue","class"]),l(c,{name:"姓名",class:"invalid-feedback"})])]),e("div",te,[e("div",oe,[le,l(i,{id:"tel",type:"tel",name:"tel",class:d(["form-control bg-transparent border border-lilac",{"is-invalid":o.tel}]),rules:n.isPhone,modelValue:t.form.user.tel,"onUpdate:modelValue":s[3]||(s[3]=a=>t.form.user.tel=a),placeholder:"請輸入電話"},null,8,["rules","modelValue","class"]),l(c,{name:"tel",class:"invalid-feedback"})])]),e("div",ae,[e("div",re,[ne,l(i,{id:"address",name:"地址",class:d(["form-control bg-transparent border border-lilac",{"is-invalid":o.地址}]),placeholder:"請輸入地區",rules:"required",modelValue:t.form.user.address,"onUpdate:modelValue":s[4]||(s[4]=a=>t.form.user.address=a),as:"select"},{default:h(()=>[ie,de,ce,me,ue,_e]),_:2},1032,["class","modelValue"]),l(c,{name:"地址",class:"invalid-feedback"})])]),e("div",be,[e("div",fe,[he,l(i,{id:"address",name:"付款方式",class:d(["form-control bg-transparent border border-lilac",{"is-invalid":o.付款方式}]),placeholder:"請輸入地區",rules:"required",modelValue:t.form.user.paid,"onUpdate:modelValue":s[5]||(s[5]=a=>t.form.user.paid=a),as:"select"},{default:h(()=>[pe,ge,ve,Ve]),_:2},1032,["class","modelValue"]),l(c,{name:"付款方式",class:"invalid-feedback"})])]),e("div",we,[ye,l(i,{id:"message",rows:"5",name:"Message",class:d(["form-control bg-transparent border border-lilac",{"is-invalid":o.Message}]),modelValue:t.form.user.message,"onUpdate:modelValue":s[6]||(s[6]=a=>t.form.user.message=a),as:"textarea"},null,8,["modelValue","class"])])]),e("div",xe,[e("button",{class:"btn btn-outline-secondary me-2",type:"button",onClick:s[7]||(s[7]=(...a)=>n.resetData&&n.resetData(...a))},"重置"),ke])]),_:1},8,["onSubmit"])])])])])],64)}const De=k(P,[["render",Ce]]);export{De as default};
